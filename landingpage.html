<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cenabastos App - Real-Time Agricultural Logistics</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- LEAFLET CSS CONECTION -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""/>
    <!-- LEAFLET JavaScript CONECTION -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>
    
    <link rel="shortcut icon" href="cenatrack1.png" style="object-fit: contain;">
              <!-- LEAFLET mapbox-API -->
          <script src='//api.tiles.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.3.1/leaflet-omnivore.min.js'></script>
    
          <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>


    <!-- 
    Chosen Palette: Harvest Tech
    Application Structure Plan: A single-page, top-to-bottom narrative structure was chosen to guide the user logically from the app's value proposition to its specific features and future vision. This flow is ideal for a landing page, as it builds interest progressively. It starts with a Hero section to capture attention, moves to the "Why" (the problem/solution), then the "How" (interactive feature showcases), and finally a "What's Next" (vision and CTA). This is more persuasive than a dashboard or tabbed layout, which would be better for an internal tool. Key interactions include smooth scrolling, hover effects on feature cards, and an interactive chart to make planned features feel tangible.
    Visualization & Content Choices: 
    - Report Info: Market complexity -> Goal: Establish need -> Presentation: Side-by-side text blocks for problem/solution -> Justification: Clearly frames the app's purpose.
    - Report Info: Real-Time Map -> Goal: Showcase core functionality -> Viz: Simulated map with animated markers (HTML/CSS) -> Justification: Visually communicates the "live tracking" concept without needing a real map API, keeping the page lightweight.
    - Report Info: User Roles -> Goal: Show tailored experience -> Viz: Interactive cards with hover effects -> Justification: Allows users to quickly grasp the app's versatility for different user types.
    - Report Info: Planned Analytics -> Goal: Demonstrate future value -> Viz: Bar Chart (Chart.js) -> Interaction: Hover tooltips -> Justification: Makes an abstract "planned feature" concrete and visually appealing, showing the kinds of insights admins will get.
    - Report Info: Virtual Assistant -> Goal: Illustrate user support -> Viz: Stylized chat interface (HTML/CSS) -> Justification: A simple, universally understood visual that communicates the feature's function instantly.
    CONFIRMATION: NO SVG graphics used. NO Mermaid JS used.
    -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #374151;
        }
        .bg-hero {
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(20250710_1043_Amanecer\ Moderno\ en\ Finca_simple_compose_01jztg10dfexyryts46sx97dj4\ \(1\).png);
            background-size: cover;
            background-position: center;
            
        }
        .nav-link {
            transition: color 0.3s;
        }
        .nav-link.active, .nav-link:hover {
            color: #3182ce;
            
        }
        .feature-card {
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
         @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .map-marker {
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid white;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 #61a848; }
            70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(37, 99, 235, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(37, 99, 235, 0); }
        }
        #map{
        height: 350px;
        width: 700px;
        margin: auto;
        margin-top: 0%;
        margin-bottom: 5%;
        z-index: 1;
        }

    </style>
</head>
<body class="antialiased">

    <header id="header" class="bg-white/80 backdrop-blur-md sticky top-0 z-[1000]  shadow-sm">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center z-[1000]">
            <a href="#" class="text-[1.570rem] font-bold text-gray-800 transform hover:scale-150 transition duration-300 ease-in-out"><img src="cenatrack1.png" alt="" style="height: 60px; width: auto;" loading="lazy"></a>
            <div class="hidden md:flex space-x-12 z-[1000]">
                <a href="#features" class="nav-link text-black-900 font-bold text-[1.570rem] transform hover:scale-125 transition duration-300 ease-in-out">Modulos</a>
                <a href="#roles" class="nav-link text-black-900 font-bold text-[1.570rem] transform hover:scale-125 transition duration-300 ease-in-out">¿Para quién es?</a>
                <a href="#vision" class="nav-link text-black-900 font-bold text-[1.570rem] transform hover:scale-125 transition duration-300 ease-in-out">Nuestra visión</a>
                <a href="#cta" class="nav-link text-black-900 font-bold text-[1.570rem] transform hover:scale-125 transition duration-300 ease-in-out">Descargar</a>
            </div>
            <button id="mobile-menu-button" class="md:hidden text-gray-700 focus:outline-none">
                 <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
            </button>
        </nav>
        <div id="mobile-menu" class="hidden md:hidden px-8 pb-6">
             <a href="#features" class="block py-2 nav-link text-gray-600 font-semibold">Módulos</a>
             <a href="#roles" class="block py-2 nav-link text-gray-600 font-semibold">¿Para quién es?</a>
             <a href="#vision" class="block py-2 nav-link text-gray-600 font-semibold">Nuestra visión</a>
             <a href="#cta" class="block py-2 nav-link text-gray-600 font-semibold">Descargar</a>
        </div>
    </header>

    <main>
        <section id="hero" class="bg-hero text-white flex items-center justify-center min-h-screen">
            <div class="container mx-auto px-7 text-center">
                <h1 class="text-4xl md:text-[1.570rem] font-bold leading-tight mb-4"></h1>
                <p class="text-lg md:text-xl text-gray-200 mb-8 max-w-[1.570rem] mx-auto"></p>
                <a href="#cta" class=" text-white font-bold py-3 px-8 rounded-full transition duration-300"></a>
            </div>
        </section>
        
        <section id="problem-solution" class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                     <h2 class="text-[1.570rem] md:text-4xl font-bold text-gray-800">Del Caos a la Coordinación</h2>
                     <p class="text-gray-500 mt-2 max-w-2xl mx-auto">Cenabastos es vibrante pero complejo para quien le visita por primera vez. Damos claridad y asistencia a los retos logísticos y geograficos que enfrenta cada día.</p>
                </div>
                <div class="grid md:grid-cols-2 gap-8 md:gap-12 items-center">
                    <div class="p-8 bg-red-50 rounded-lg border border-red-200">
                        <h3 class="text-2xl font-semibold text-red-800 mb-4">El Reto Diario</h3>
                        <p class="text-red-700">Navegar por un mercado logísticamente complejo e informal conduce a ineficiencias, pérdida de tiempo y oportunidades perdidas. La falta de información en tiempo real dificulta y genera estrés la coordinación entre proveedores, compradores y transportistas.</p>
                    </div>
                    <div class="p-8 bg-green-50 rounded-lg border border-green-200">
                        <h3 class="text-2xl font-semibold text-green-800 mb-4">La Solución Digital</h3>
                        <p class="text-green-700">Nuestra aplicación centraliza la información y la comunicación, proporcionando una vista panorámica en vivo de la actividad del mercado. Le proporciona los datos necesarios para navegar de manera eficiente, conectarse sin problemas y hacer crecer su negocio.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="features" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                     <h2 class="text-[1.570rem] md:text-4xl font-bold text-gray-800">Características Principales</h2>
                     <p class="text-gray-500 mt-2 max-w-2xl mx-auto">Herramientas diseñadas para mejorar la visibilidad, la toma de decisiones y la coordinación.</p>
                </div>

                <div class="grid md:grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                    <div class="feature-card bg-white p-8 rounded-lg shadow-lg">
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">Mapa Interactivo en Tiempo Real</h3>
                        <p class="text-gray-600 mb-6">Vea el mercado como nunca antes. Nuestro mapa en vivo muestra las posiciones actuales de los usuarios y vehículos activos. Los íconos personalizados brindan contexto instantáneo para cada marcador, ayudándole a encontrar a quien necesita, justo cuando lo necesita. Evite la congestión y optimice sus rutas al instante.</p>
                        <div class="relative w-full h-64 bg-gray-200 rounded-lg overflow-hidden">
                            <div id="map" width="100%" height="auto" alt="Mapa de Cenabastos con marcadores de ubicación"   ></div>
                             </div>
                    </div>

                     <div class="feature-card bg-white p-8 rounded-lg shadow-lg">
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">Asistente Virtual (Chatbot)</h3>
                        <p class="text-gray-600 mb-6">¿Tienes una pregunta? Obtén ayuda al instante. Nuestro chatbot de IA integrado brinda soporte conversacional y orientación para preguntas frecuentes y tareas comunes. Es como tener un guía útil disponible 24/7, diseñado para que tu experiencia sea fluida y productiva.</p>
                         <div class="w-full h-64 bg-gray-100 rounded-lg p-4 flex flex-col">
                            <div class="flex-grow space-y-3">
                                <div class="w-3/4 bg-green-100 text-green-800 p-2 rounded-lg">¡Hola! ¿En qué puedo ayudarte hoy?</div>
                                <div class="flex justify-end">
                                    <div class="w-3/4 bg-gray-200 p-2 rounded-lg">¿Dónde es el mejor lugar para parquear?</div>
                                </div>
                                <div class="w-3/4 bg-green-100 text-green-800 p-2 rounded-lg">La Zona 3 tiene poco tráfico en este momento. Puedo guiarte allí.</div>
                            </div>
                            <div class="mt-4 flex">
                                <input type="text" placeholder="Escribe un mensaje..." class="w-full p-2 border rounded-l-lg focus:outline-none" disabled>
                                <button class="bg-green-600 text-white p-2 rounded-r-lg">Enviar</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="roles" class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-[1.570rem] md:text-4xl font-bold text-gray-800">Una App para Todos</h2>
                    <p class="text-gray-500 mt-2 max-w-2xl mx-auto">Ofrecemos una experiencia personalizada para cada participante de la cadena de suministro de Cenabastos a través de un sistema seguro y basado en roles.</p>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="feature-card text-center p-6 bg-white rounded-lg border">
                        <div class="text-4xl mb-4">🛒</div>
                        <h3 class="text-xl font-bold mb-2">Compradores</h3>
                        <p class="text-gray-600">Ubica rápidamente a los vendedores, consulta la disponibilidad de productos y planifica tus compras de manera eficiente.</p>
                    </div>
                    <div class="feature-card text-center p-6 bg-white rounded-lg border">
                         <div class="text-4xl mb-4">🌱</div>
                        <h3 class="text-xl font-bold mb-2">Vendedores</h3>
                        <p class="text-gray-600">Aumenta tu visibilidad, gestiona el estado de tu puesto y conecta con más compradores.</p>
                    </div>
                    <div class="feature-card text-center p-6 bg-white rounded-lg border">
                         <div class="text-4xl mb-4">🚚</div>
                        <h3 class="text-xl font-bold mb-2">Transportistas</h3>
                        <p class="text-gray-600">Encuentra las rutas más rápidas, visualiza la congestión en tiempo real y coordina recogidas y entregas sin complicaciones.</p>
                    </div>
                    <div class="feature-card text-center p-6 bg-white rounded-lg border">
                         <div class="text-4xl mb-4">📊</div>
                        <h3 class="text-xl font-bold mb-2">Administradores</h3>
                        <p class="text-gray-600">Supervisa la actividad del mercado, analiza los patrones de movimiento y optimiza el uso del espacio con potentes analíticas.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="vision" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                     <h2 class="text-[1.570rem] md:text-4xl font-bold text-gray-800">El Futuro es Impulsado por Datos</h2>
                     <p class="text-gray-500 mt-2 max-w-2xl mx-auto">Nuestro trabajo no termina aquí. Continuamente desarrollamos nuevas funciones para aportar aún más valor y conocimiento a la comunidad de Cenabastos.</p>
                </div>
                <div class="grid md:grid-cols-2 gap-8 md:gap-12 items-center">
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">Panel de Control y Analíticas (Próximamente)</h3>
                        <p class="text-gray-600 mb-4 text-justify">Para los administradores, estamos construyendo un panel integral para visualizar el movimiento de usuarios, identificar horas pico y analizar registros de interacción. Estos conocimientos ayudarán a optimizar el flujo del mercado y la asignación de recursos, creando un entorno más eficiente para todos.</p>
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">Datos Históricos y Registros de Ubicación (Próximamente)</h3>
                        <p class="text-gray-600">Al analizar los datos históricos de movimiento, podemos desbloquear potentes herramientas para la planificación logística, la rendición de cuentas y el análisis de tendencias. Esta función proporcionará un nivel de comprensión sin precedentes sobre la dinámica a largo plazo del mercado.</p>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-lg">
                        <div class="chart-container">
                            <canvas id="analyticsChart"></canvas>
                        </div>
                        <p class="text-center text-sm text-gray-500 mt-4">Ejemplo: Visualización de la densidad de usuarios por zona del mercado para gestionar la congestión.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="cta" class="py-16 md:py-24 bg-blue-600 text-white">
            <div class="container mx-auto px-6 text-center">
                 <h2 class="text-[1.570rem] md:text-4xl font-bold mb-4">¿Listo para transformar tu día en el mercado?</h2>
                 <p class="text-blue-100 mb-8 max-w-2xl mx-auto">Descarga la App de Cenabastos hoy y únete a la comunidad de vendedores, compradores y transportistas visionarios que están construyendo un mercado más eficiente y conectado.</p>
                 <div class="flex justify-center space-x-4">
                     <a href="#" class="bg-white text-blue-600 font-bold py-3 px-6 rounded-lg transition duration-300 hover:bg-gray-100">Descargar para iOS</a>
                     <a href="#" class="bg-gray-800 text-white font-bold py-3 px-6 rounded-lg transition duration-300 hover:bg-gray-700">Descargar para Android</a>
                 </div>
            </div>
        </section>
    </main>
    
    <footer class="w-full bg-gray-800 flex flex-col md:flex-row justify-between items-center px-4 md:px-16 py-10 gap-8">
      <!-- Card: Logo + Text -->
      <div class="flex flex-col md:flex-row items-center md:items-start gap-4 md:gap-6 w-full md:w-1/2 max-w-xl">
        <img src="cenatrack1.png" alt="Logo CenaTrack" class="w-24 h-24 object-contain rounded-lg shadow-md bg-white p-2" />
        <div>
          <h5 class="text-lg font-bold text-white font-inter mb-1">CenaTrack</h5>
          <p class="text-sm text-white font-inter mb-2 max-w-xs text-justify">
            Diseñado y construido con todo el amor del mundo por el equipo de 
            <a href="#" class="team text-blue-300 hover:font-inter hover:text-base">CenaTrack</a> con la ayuda de nuestros instructores y todo el equipo SENA.
          </p>
          <p class="text-sm text-white font-inter mb-2 max-w-xs">&copy; 2025 CenaTrack. Todos los derechos reservados.</p>
        </div>
      </div>
      <!-- Footer Form -->
      <form action="#" method="POST" class="flex flex-col items-center w-full md:w-1/2 max-w-xl gap-3">
        <div class="flex flex-col sm:flex-row gap-3 w-full">
          <input type="text" name="NOMBRES_Y_APELLIDOS" placeholder="Ingresa tu nombre o apodo" required
            class="w-full sm:w-1/2 px-3 py-2 border-b-2 border-white bg-transparent text-white placeholder-white  font-inter focus:outline-none focus:border-white  transition" />
          <input type="email" name="CORREO_ELECTRONICO" placeholder="Ingresa tu correo electrónico" required
            class="w-full sm:w-1/2 px-3 py-2 border-b-2 border-white bg-transparent text-white placeholder-white font-inter focus:outline-none focus:border-white transition" />
        </div>
        <textarea name="SUGERENCIAS" rows="3" maxlength="500" placeholder="¿En qué podemos mejorar? (Máximo 500 caracteres)" required
          class="w-full px-3 py-2 border border-blue-600 rounded-lg font-inter mt-1 resize-vertical focus:outline-none focus:border-white  placeholder-gray-800 transition"></textarea>
        <button type="submit" class="bg-white text-gray-800 font-bold text-lg px-8 py-2 rounded-lg mt-2 w-1/2 hover:bg-whitetransition">Ingresar</button>
      </form>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('main section');
            
            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.5 
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        navLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === `#${id}`) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, observerOptions);
            
            sections.forEach(section => {
                observer.observe(section);
            });
            
            const chartCtx = document.getElementById('analyticsChart').getContext('2d');
            const analyticsChart = new Chart(chartCtx, {
                type: 'bar',
                data: {
                    labels: ['Zone A', 'Zone B', 'Zone C', 'Zone D', 'Zone E', 'Zone F'],
                    datasets: [{
                        label: 'Current User Density',
                        data: [65, 59, 80, 81, 56, 95],
                        backgroundColor: 'rgba(37, 99, 235, 0.6)',
                        borderColor: 'rgba(37, 99, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                             display: true,
                             text: 'Market Activity by Zone',
                             font: {
                                size: 16
                             },
                             color: '#333'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                             grid: {
                                color: '#e5e7eb'
                            }
                        },
                        x: {
                             grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        });

        //objeto de creación y despliegue del mapa
var map = L.map('map').setView([7.9245969061005835,-72.49189616570473], 16.5);
L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
}).addTo(map);
// Importing firebase app initialization
/* import firebase from "firebase/compat/app";
import {initializeApp} from "firebase/app";
import {getAuth} from "firebase/auth";
import {getFirestore} from "firebase/firestore";
*/

// Importing firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyCV8KCcdv_ioyxP31Sj2UiJr7F_imj4d6o",
  authDomain: "soycenabastos-live-map-demoweb.firebaseapp.com",
  databaseURL: "https://soycenabastos-live-map-demoweb-default-rtdb.firebaseio.com",
  projectId: "soycenabastos-live-map-demoweb",
  storageBucket: "soycenabastos-live-map-demoweb.firebasestorage.app",
  messagingSenderId: "865907759041",
  appId: "1:865907759041:web:915cd3d44a44eab11a0140",
  measurementId: "G-ZYDLDB8SQQ"
};
    

    firebase.initializeApp(firebaseConfig);
    
    const db = firebase.database();

// Initialize Firebase app





// GeoJSON data for points and lines
var IntPointsGeoJson=
{
    "type": "FeatureCollection",
    "features": 
        [
    {
        "type": "Feature",
        "properties": {},
      "geometry": {
          "coordinates": [
              -72.49282147971168,
          7.925070364711516
        ],
        "type": "Point"
    }
        
    },{
      "type": "Feature",
      "properties": {},
      "geometry": {
        "coordinates": [
         -72.49342283632522,
         7.926149928643696
        ],
        "type": "Point"
                    }
                }
        ]
    }
    
    var IntLinesGeoJson =
        {
          "type": "Feature",
          "properties": {},
          "geometry": {
            "coordinates": [
              [
                -72.49264346809639,
                7.922954193558198
              ],
              [
                -72.49254720389833,
                7.923514346763909
              ],
              [
                -72.49290819464252,
                7.926350855547142
              ]
            ],
            "type": "LineString"
                    }
        };
    
        // Add the GeoJSON layers to the map
    //L.geoJSON(IntPointsGeoJson, {}).addTo(map);
    //L.geoJSON(IntLinesGeoJson, {
      //  style: {
      //      color: 'blue',
      //      opacity: 0.5,
       //     weight: 5,
      //  }
   // }).addTo(map);


// Adding a object for a marker with a custom icon (persona)
var myIcon = L.icon({
    iconUrl: "persona.png",
    iconSize: [50, 50],
    iconAnchor: [25, 50],
    popupAnchor: [0, -50],
    shadowUrl: "",
    shadowSize: [68, 95],
    shadowAnchor: [22, 94]
});


// Adding a marker to the map with the custom icon {}
L.marker([7.9249173,-72.4918418],{icon:myIcon}).addTo(map)
.bindPopup(' La Central de Abastos de todos los Nortesantandereanos.<br> Cenabastos.')
.openPopup();

// Adding a circle to the map
// var circle= L.circle([7.9249173,-72.4918418,32], {
   //  color: '#88A66A',
    // fillColor: '#88A66A',
    // fillOpacity: 0.5,
  //   radius: 40
// }).addTo(map);

// Adding a circle to the map with each new user
// 👤 Track user location
    const userId = "user_" + Math.floor(Math.random() * 100000);
    navigator.geolocation.watchPosition((pos) => {
      const lat = pos.coords.latitude;
      const lng = pos.coords.longitude;
      db.ref("users/" + userId).set({ lat, lng, timestamp: Date.now() });
    });

    // 👥 Show all markers
    const markers = {};
    db.ref("users").on("value", (snapshot) => {
      const users = snapshot.val();
      if (!users) return;

       for (let id in users) {
    const u = users[id];
    const latLng = [u.lat, u.lng];

    if (markers[id]) {
      // ✅ Move marker if it already exists
      markers[id].setLatLng(latLng);
    } else {
      // ✅ Create new marker
      markers[id] = L.marker(latLng, { icon: myIcon }).addTo(map)
        .bindPopup("User: " + id);
    }
  }
});

      /*for (let id in markers) map.removeLayer(markers[id]);
      for (let id in users) {
        const u = users[id];
        markers[id] = L.marker([u.lat, u.lng],{icon:myIcon}).addTo(map)
          .bindPopup("User: " + id);
          
      }
    });*/

/* function addCircle(lat, lng) {
    L.circle([lat, lng], {
        color: '#FF0000',
        fillColor: '#FF0000',
        fillOpacity: 0.5,
        radius: 20
    }).addTo(map);
}*/


function onMapClick(latitud) {
    alert("Has dado click en latitud: " + latitud.latlng.lat +" y longitud:" + latitud.latlng.lng );
} map.on('click', onMapClick);
    </script>

</body>
</html>
